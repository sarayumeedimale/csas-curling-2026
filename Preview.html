<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Armaan and Sarayu">

<title>CSAS 2026: Analyzing Power Play Performance</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Preview_files/libs/clipboard/clipboard.min.js"></script>
<script src="Preview_files/libs/quarto-html/quarto.js"></script>
<script src="Preview_files/libs/quarto-html/popper.min.js"></script>
<script src="Preview_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Preview_files/libs/quarto-html/anchor.min.js"></script>
<link href="Preview_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Preview_files/libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Preview_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Preview_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Preview_files/libs/bootstrap/bootstrap-32162a2fca7cb0439643f2faaab1edf3.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#quarto" id="toc-quarto" class="nav-link active" data-scroll-target="#quarto">Quarto</a></li>
  <li><a href="#running-code" id="toc-running-code" class="nav-link" data-scroll-target="#running-code">Running Code</a></li>
  <li><a href="#the-anxious-sniper-quantifying-strategic-regression-in-high-stakes-mixed-doubles-curling" id="toc-the-anxious-sniper-quantifying-strategic-regression-in-high-stakes-mixed-doubles-curling" class="nav-link" data-scroll-target="#the-anxious-sniper-quantifying-strategic-regression-in-high-stakes-mixed-doubles-curling"><strong>The Anxious Sniper: Quantifying Strategic Regression in High-Stakes Mixed Doubles Curling</strong></a>
  <ul class="collapse">
  <li><a href="#a-2026-csas-data-challenge-submission" id="toc-a-2026-csas-data-challenge-submission" class="nav-link" data-scroll-target="#a-2026-csas-data-challenge-submission"><strong>A 2026 CSAS Data Challenge Submission</strong></a></li>
  </ul></li>
  <li><a href="#executive-summary" id="toc-executive-summary" class="nav-link" data-scroll-target="#executive-summary"><strong>1. Executive Summary</strong></a></li>
  <li><a href="#data-and-methodology" id="toc-data-and-methodology" class="nav-link" data-scroll-target="#data-and-methodology"><strong>2. Data and Methodology</strong></a>
  <ul class="collapse">
  <li><a href="#data-source-and-preprocessing" id="toc-data-source-and-preprocessing" class="nav-link" data-scroll-target="#data-source-and-preprocessing"><strong>2.1 Data Source and Preprocessing</strong></a></li>
  <li><a href="#quantifying-the-intangible-the-pressure-metrics" id="toc-quantifying-the-intangible-the-pressure-metrics" class="nav-link" data-scroll-target="#quantifying-the-intangible-the-pressure-metrics"><strong>2.2 Quantifying the Intangible: The Pressure Metrics</strong></a></li>
  <li><a href="#the-power-play-clutch-score-ppcs" id="toc-the-power-play-clutch-score-ppcs" class="nav-link" data-scroll-target="#the-power-play-clutch-score-ppcs"><strong>2.3 The Power Play Clutch Score (PPCS)</strong></a></li>
  <li><a href="#predictive-modeling-the-odds-of-success" id="toc-predictive-modeling-the-odds-of-success" class="nav-link" data-scroll-target="#predictive-modeling-the-odds-of-success"><strong>2.4 Predictive Modeling: The Odds of Success</strong></a></li>
  </ul></li>
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results"><strong>3. Results</strong></a>
  <ul class="collapse">
  <li><a href="#finding-1-the-anxious-sniper-effect" id="toc-finding-1-the-anxious-sniper-effect" class="nav-link" data-scroll-target="#finding-1-the-anxious-sniper-effect"><strong>3.1 Finding 1: The Anxious Sniper Effect</strong></a></li>
  <li><a href="#finding-2-the-shot-2-protection-strategy" id="toc-finding-2-the-shot-2-protection-strategy" class="nav-link" data-scroll-target="#finding-2-the-shot-2-protection-strategy"><strong>3.2 Finding 2: The Shot 2 Protection Strategy</strong></a></li>
  <li><a href="#finding-3-team-rankings-ppcs" id="toc-finding-3-team-rankings-ppcs" class="nav-link" data-scroll-target="#finding-3-team-rankings-ppcs"><strong>3.3 Finding 3: Team Rankings (PPCS)</strong></a></li>
  <li><a href="#case-study-the-italian-model-vs.-the-american-regression" id="toc-case-study-the-italian-model-vs.-the-american-regression" class="nav-link" data-scroll-target="#case-study-the-italian-model-vs.-the-american-regression"><strong>3.4 Case Study: The Italian Model vs.&nbsp;The American Regression</strong></a></li>
  </ul></li>
  <li><a href="#discussion-and-implications" id="toc-discussion-and-implications" class="nav-link" data-scroll-target="#discussion-and-implications"><strong>4. Discussion and Implications</strong></a>
  <ul class="collapse">
  <li><a href="#for-coaches-abandon-the-shot-1-guard" id="toc-for-coaches-abandon-the-shot-1-guard" class="nav-link" data-scroll-target="#for-coaches-abandon-the-shot-1-guard"><strong>4.1 For Coaches: Abandon the Shot 1 Guard</strong></a></li>
  <li><a href="#training-the-anxious-sniper-the-pressure-cooker-drill" id="toc-training-the-anxious-sniper-the-pressure-cooker-drill" class="nav-link" data-scroll-target="#training-the-anxious-sniper-the-pressure-cooker-drill"><strong>4.2 Training the Anxious Sniper: The “Pressure Cooker” Drill</strong></a></li>
  <li><a href="#for-scouts-weaponizing-the-ppcs" id="toc-for-scouts-weaponizing-the-ppcs" class="nav-link" data-scroll-target="#for-scouts-weaponizing-the-ppcs"><strong>4.3 For Scouts: Weaponizing the PPCS</strong></a></li>
  <li><a href="#the-false-clutch-implications" id="toc-the-false-clutch-implications" class="nav-link" data-scroll-target="#the-false-clutch-implications">4.4 The “False Clutch” Implications</a></li>
  <li><a href="#limitations" id="toc-limitations" class="nav-link" data-scroll-target="#limitations"><strong>4.4 Limitations</strong></a></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><strong>5. Conclusion</strong></a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">CSAS 2026: Analyzing Power Play Performance</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Armaan and Sarayu </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="quarto" class="level2">
<h2 class="anchored" data-anchor-id="quarto">Quarto</h2>
<p>Quarto enables you to weave together content and executable code into a finished document. To learn more about Quarto see <a href="https://quarto.org" class="uri">https://quarto.org</a>.</p>
</section>
<section id="running-code" class="level2">
<h2 class="anchored" data-anchor-id="running-code">Running Code</h2>
<p>When you click the <strong>Render</strong> button a document will be generated that includes both content and the output of embedded code. You can embed code like this:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">+</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
</div>
<p>You can add options to executable code like this</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4</code></pre>
</div>
</div>
<p>The <code>echo: false</code> option disables the printing of code (only output is displayed)</p>
</section>
<section id="the-anxious-sniper-quantifying-strategic-regression-in-high-stakes-mixed-doubles-curling" class="level2">
<h2 class="anchored" data-anchor-id="the-anxious-sniper-quantifying-strategic-regression-in-high-stakes-mixed-doubles-curling"><strong>The Anxious Sniper: Quantifying Strategic Regression in High-Stakes Mixed Doubles Curling</strong></h2>
<section id="a-2026-csas-data-challenge-submission" class="level3">
<h3 class="anchored" data-anchor-id="a-2026-csas-data-challenge-submission"><strong>A 2026 CSAS Data Challenge Submission</strong></h3>
</section>
</section>
<section id="executive-summary" class="level2">
<h2 class="anchored" data-anchor-id="executive-summary"><strong>1. Executive Summary</strong></h2>
<p><strong>Mixed Doubles: The Most Common Format of Doubles Curling</strong></p>
<p>Mixed doubles curling is a faster-paced, two-person version of traditional curling, featuring one male and one female player per team, with unique rules like pre-placed stones at the start of each end, five stones thrown per end (instead of eight), and a power play option for the team with the hammer, making for more strategic, quicker games. Within this chaotic environment, the Power Play represents the sport’s “nuclear option” being a single-use strategic advantage available to each team once per game when they hold the hammer (last rock advantage). Yet, despite its critical importance, its deployment remains governed by intuition rather than evidence. Teams use it blindly, often when the pressure is highest, without understanding the statistical probabilities of success.</p>
<p><strong>The Agitation: The Paradox of the Anxious Sniper<br>
</strong>When the pressure mounts in the final ends, elite teams do not “choke” in the traditional physical sense as their execution metrics remain remarkably robust. Instead, they retreat. Our analysis of over 26,000 international stone observations reveals a phenomenon we term the <strong>“Anxious Sniper.”</strong></p>
<p>The data shows that while players maintain high execution scores under pressure, this is partly driven by a shift toward mechanically easier defensive shots (Guards). They possess the “Sniper” capability to hit the target, evidenced by high execution scores, but they refuse to pull the trigger on complex scoring shots (Draws), opting instead for safety. This conservative pivot limits scoring output despite high execution metrics, neutralizing the Power Play’s inherent advantage. They don’t lose because they miss; they lose because they play not to lose.</p>
<p><strong>The Solution: Quantifying Clutch Performance<br>
</strong>This report provides the analytical playbook to break that cycle. By introducing the <strong>Power Play Clutch Score (PPCS)</strong> and the <strong>Shot 2 Protection Strategy</strong>, we quantify exactly which nations thrive under pressure and identify the counter-intuitive shot sequences that mathematically maximize gold-medal potential.</p>
</section>
<section id="data-and-methodology" class="level2">
<h2 class="anchored" data-anchor-id="data-and-methodology"><strong>2. Data and Methodology</strong></h2>
<section id="data-source-and-preprocessing" class="level3">
<h3 class="anchored" data-anchor-id="data-source-and-preprocessing"><strong>2.1 Data Source and Preprocessing</strong></h3>
<p>The dataset for this analysis consists of stone-by-stone tracking data provided by Curlit, covering four major international competitions: the 2022 Beijing Winter Olympics and the 2023, 2024, and 2025 World Mixed Doubles Championships.</p>
<p>The raw data was filtered to isolate <strong>Power Play ends</strong>, resulting in a sample of approximately 600 distinct ends and nearly 3,000 individual shots. Data cleaning involved:</p>
<ul>
<li><p><strong>Sentinel Value Handling:</strong> Converting sensor errors (coordinates marked as 4095) to NA.</p></li>
<li><p><strong>Game State Reconstruction:</strong> Recalculating the score differential and “Ends Remaining” at the start of every shot to accurately map the game context.</p></li>
<li><p><strong>Shot Categorization:</strong> To facilitate modeling, the 14 raw Task codes were grouped into three functional categories: Guard/Setup (defensive), Draw/Offense (scoring), and Takeout (clearing). This dimensionality reduction was necessary to prevent overfitting given the specific nuances of curling shot-calling.</p></li>
</ul>
</section>
<section id="quantifying-the-intangible-the-pressure-metrics" class="level3">
<h3 class="anchored" data-anchor-id="quantifying-the-intangible-the-pressure-metrics"><strong>2.2 Quantifying the Intangible: The Pressure Metrics</strong></h3>
<p>To measure performance “under pressure,” we rejected a binary “win/loss” outcome in favor of a context-aware <strong>Pressure Index</strong>. We define “pressure” not as a feeling, but as a mathematical reality of the game state. We utilized two validation methods:</p>
<p><strong>A. Game Situation Pressure (Heuristic)<br>
</strong>This is a rule-based classification derived from coaching intuition. An end is classified as “High Pressure” if:&nbsp;&nbsp;&nbsp;<span class="math display">\[
\text{Ends\_Remaining} \leq 2 \quad \text{AND} \quad |\text{Score\_Differential}| \leq 2
\]</span></p>
<p>This captures the “Late and Close” scenarios where a single mistake results in a loss.</p>
<p><strong>B. Win Probability Leverage (Stochastic)<br>
</strong>To validate the heuristic, we trained a baseline logistic regression model to</p>
<p>predict the probability of a team winning the match (<span class="math inline">\(P_{win}\)</span>) based on three state variables: Score Differential, Hammer Possession, and End Number.From this, we calculated the Leverage Index (<span class="math inline">\(LI\)</span>) for every Power Play end. The Leverage Index represents the volatility or importance of the end:</p>
<p><span class="math display">\[
LI = |P(Win)_{post-end} - P(Win)_{pre-end}|
\]</span></p>
<p>Ends with the highest quartile of (?) were classified as High Pressure. Correlation analysis showed strong agreement between the Heuristic and Stochastic definitions. For the final analysis, we utilized a Combined Pressure Metric, where “Very High” pressure denotes ends that satisfy the Game Situation criteria and possess high Leverage.</p>
</section>
<section id="the-power-play-clutch-score-ppcs" class="level3">
<h3 class="anchored" data-anchor-id="the-power-play-clutch-score-ppcs"><strong>2.3 The Power Play Clutch Score (PPCS)</strong></h3>
<p>We developed the PPCS to normalize team performance against their own baseline. A raw scoring average is insufficient because stronger teams naturally score more points regardless of context. The PPCS isolates the “clutch” variable: <span class="math display">\[
PPCS = \mu_{HighPressure} - \mu_{LowPressure}
\]</span></p>
<p>Where <span class="math inline">\(\mu\)</span> represents the average points scored per Power Play end. A positive PPCS indicates a team that elevates their scoring output when the game is on the line (a “Clutch” performance), while a negative score indicates a performance regression.</p>
</section>
<section id="predictive-modeling-the-odds-of-success" class="level3">
<h3 class="anchored" data-anchor-id="predictive-modeling-the-odds-of-success"><strong>2.4 Predictive Modeling: The Odds of Success</strong></h3>
<p>To determine the optimal shot selection strategy, we employed a multivariate logistic regression model. The goal was to isolate the marginal effect of specific shot choices while controlling for pressure.</p>
<p><strong>Model Specification:<br>
</strong><br>
&nbsp;<span class="math display">\[
\ln\left(\frac{P(Success)}{1-P(Success)}\right) = \beta_0 + \beta_1 S_1 + \beta_2 S_2 + \beta_3 \pi + \beta_4 (S_1 \times \pi) + \epsilon
\]</span></p>
<p><strong>Dependent Variable</strong></p>
<ul>
<li><p><span class="math inline">\(P(Success)\)</span>: The probability of scoring<br>
&nbsp; &nbsp; &nbsp; &nbsp; ≥2\ge 2≥2</p></li>
<li><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
points (the strategic goal of a Power Play).</p></li>
</ul>
<p><strong>S1S_1S1​</strong></p>
<ul>
<li><strong><br>
</strong> : Shot 1 Type (Categorical: Guard vs.&nbsp;Draw vs.&nbsp;Takeout).</li>
</ul>
<p><strong>S2S_2S2​</strong></p>
<ul>
<li><strong><br>
</strong> : Shot 2 Type (Categorical).</li>
</ul>
<p><strong>π\piπ</strong></p>
<ul>
<li><strong><br>
</strong> : Pressure Level (Ordinal).</li>
</ul>
<p><strong>S1×πS_1 \times \piS1​×π</strong></p>
<ul>
<li><strong><br>
</strong> : Interaction term to determine if specific shots perform better or worse as pressure increases.</li>
</ul>
<p><strong>Modeling Caveat:</strong> While we controlled for shot type and game state, “Player Skill” remains an omitted variable due to the limitations of anonymized aggregated data. Therefore, results should be interpreted as strategic tendencies rather than isolated physics simulations.</p>
</section>
</section>
<section id="results" class="level2">
<h2 class="anchored" data-anchor-id="results"><strong>3. Results</strong></h2>
<section id="finding-1-the-anxious-sniper-effect" class="level3">
<h3 class="anchored" data-anchor-id="finding-1-the-anxious-sniper-effect"><strong>3.1 Finding 1: The Anxious Sniper Effect</strong></h3>
<p>The analysis of the Points column (a 0-4 subjective measure of shot execution) reveals the core tension of Mixed Doubles strategy.</p>
<ul>
<li><p><strong>Low Pressure Execution:</strong> 2.96 / 4.0 average score.</p></li>
<li><p><strong>High Pressure Execution:</strong> 3.13 / 4.0 average score.</p></li>
</ul>
<p>Superficially, it appears players improve under pressure. However, deeper analysis reveals this is likely <strong>Selection Bias</strong> rather than a clutch performance boost. As pressure shifts to “Very High,” teams increase their usage of <strong>Guards</strong> (from ~5.4% to ~6.9% of early shots).</p>
<p>Mechanically, a Guard is a “safer” shot than a precision Draw or a high-weight Takeout; it has a larger margin for error while still receiving a positive execution score. By switching to these safer shots, teams artificially inflate their execution metrics while simultaneously cluttering the house, which ironically correlates with lower scoring output. They are executing “safe” shots perfectly, but those shots do not contribute to the offensive generation required to score 2+ points.</p>
<p><strong>Figure 1: The “Anxious Sniper” Effect.<br>
</strong>This chart illustrates the disconnect between physical execution and tactical outcome. The bars represent average shot quality (0-4 scale), which remains robust or even improves as pressure rises to “Very High.” However, this precision does not translate into linear scoring growth. The data suggests that teams maintain high execution scores by switching to mechanically easier defensive shots (Guards) rather than attempting the high-difficulty offensive shots required to score big ends.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="output/figures/fig1_scoring_by_pressure.png" class="img-fluid figure-img"></p>
<figcaption>The Anxious Sniper Effect: High execution scores vs.&nbsp;low scoring output.</figcaption>
</figure>
</div>
<p>However, averages conceal individual collapses. When we untangle the data by nation, we see distinct behavioral phenotypes: those like NZL who capitalize on the moment, and those like EST who buckle.</p>
<div id="fig-pressure-curves" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pressure-curves-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="output/figures/fig5_pressure_curves.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pressure-curves-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Pressure curves across different match scenarios
</figcaption>
</figure>
</div>
</section>
<section id="finding-2-the-shot-2-protection-strategy" class="level3">
<h3 class="anchored" data-anchor-id="finding-2-the-shot-2-protection-strategy"><strong>3.2 Finding 2: The Shot 2 Protection Strategy</strong></h3>
<p>Our predictive model aimed to identify the opening sequence that maximizes the probability of a multi-point end. The model isolated the <strong>Second Shot</strong> (the non-hammer team’s response or the hammer team’s setup) as a critical pivot point.</p>
<ol type="1">
<li><p><strong>Shot 1 Guard (The Mistake):</strong> Throwing a guard on the very first shot has an Odds Ratio (OR) of <strong>0.59</strong>. This implies that starting with a guard decreases the odds of a successful Power Play by roughly 41%.</p></li>
<li><p><strong>Shot 2 Protection (The Strategy):</strong> If the sequence involves establishing a stone in the house followed by a <strong>Shot 2 Guard</strong>, the Odds Ratio rises to <strong>3.44</strong>.</p></li>
</ol>
<p><strong>Statistical Caveat:</strong> It is vital to note that while the effect size is large (OR: 3.44), the confidence intervals are wide (<span class="math inline">\(1.09 - 13.19\)</span>) and the p-value is marginal (<span class="math inline">\(0.046\)</span>). This is due to the rarity of this specific sequence in the dataset (<span class="math inline">\(n &lt; 30\)</span>). While we cannot call this a “Golden Rule” without more data, the signal represents a significant market inefficiency. The logical inference is strong: establishing a scoring threat first (Shot 1 Draw) and then protecting it (Shot 2 Guard) is superior to pre-guarding an empty house.</p>
<p><strong>Figure 2: Predictors of Power Play Success.<br>
</strong>A forest plot of the logistic regression coefficients. Note that “Shot 1 Guard” (green dot, left) is associated with failure, while “Shot 2 Guard” (green dot, right) is strongly associated with success (OR 3.44), identifying a high-value but under-utilized tactic.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="output/figures/fig2_shot_selection.png" class="img-fluid figure-img"></p>
<figcaption>Shot Selection Analysis.</figcaption>
</figure>
</div>
<p>Our model looks at what really drives these outcomes. You’ll see in the next graph that while pressure impacts every player, certain shots have a much wider range of success and failure. This volatility suggests that for a smart team, these moments are where you can actually win the game by making a tactical choice the other team is too afraid to try</p>
<div id="fig-model-coeffs" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-model-coeffs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="output/figures/fig4_model_coefficients.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-model-coeffs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Model coefficients for pressure performance factors
</figcaption>
</figure>
</div>
</section>
<section id="finding-3-team-rankings-ppcs" class="level3">
<h3 class="anchored" data-anchor-id="finding-3-team-rankings-ppcs"><strong>3.3 Finding 3: Team Rankings (PPCS)</strong></h3>
<p>Applying the Power Play Clutch Score (PPCS) allows us to categorize teams based on their resilience.</p>
<p><strong>The Antifragile (Clutch Performers):</strong></p>
<ul>
<li><p><strong>Italy (ITA):</strong> PPCS <strong>+1.75</strong>. Italy represents the gold standard for pressure adaptation. They average 0.0 points in low-pressure “blanking” scenarios but surge to 1.75 points under high pressure. They do not fear the moment; they optimize for it.</p></li>
<li><p><strong>New Zealand (NZL):</strong> PPCS <strong>+2.67</strong>. Note: While NZL displays the highest raw differential, these results should be interpreted with caution due to a smaller sample size of high-pressure ends compared to perennial contenders like Italy.</p></li>
</ul>
<p><strong>The Regressors:</strong></p>
<ul>
<li><p><strong>United States (USA):</strong> PPCS <strong>-0.22</strong>. The USA shows a statistically significant “leak” in performance. They average 2.0 points in low pressure but drop to 1.78 in high pressure. This regression suggests a tendency toward conservatism when the game is on the line.</p></li>
<li><p><strong>Estonia (EST):</strong> PPCS <strong>-1.5</strong>. A sharp decline from 3.0 points (Low) to 1.5 points (High), indicating a struggle to maintain offensive efficiency under stress.</p></li>
</ul>
<p><strong>Figure 3: The Power Play Clutch Score (PPCS).<br>
</strong>Who rises when the game is on the line? This lollipop chart ranks teams by their scoring differential between High-Pressure and Low-Pressure Power Plays.</p>
<ul>
<li><p><strong>Green (Top):</strong> Teams like <strong>Italy (ITA)</strong> and <strong>New Zealand (NZL)</strong> display actually score more points when the stakes are highest.</p></li>
<li><p><strong>Red (Bottom):</strong> Teams like the <strong>USA</strong> and <strong>Estonia</strong> show signs of regression, where their average offensive output leaks value in critical late-game scenarios. This provides scouts with a clear target: force these teams into complex decisions late in the game.</p>
<div id="fig-rankings" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-rankings-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="output/figures/fig3_ppcs_rankings.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-rankings-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: PPCS Rankings by Team
</figcaption>
</figure>
</div></li>
</ul>
</section>
<section id="case-study-the-italian-model-vs.-the-american-regression" class="level3">
<h3 class="anchored" data-anchor-id="case-study-the-italian-model-vs.-the-american-regression"><strong>3.4 Case Study: The Italian Model vs.&nbsp;The American Regression</strong></h3>
<p>To visualize the impact of PPCS, let us apply our findings to a hypothetical but common Olympic scenario: <strong>End 7, Tied Game (6-6), Hammer Possession.</strong></p>
<p><strong>The American Approach (Regressive):<br>
</strong>The USA, with a negative PPCS, historically reverts to the “Shot 1 Guard” in this high-leverage moment. The data suggests an attempt to close down the center line to prevent a steal.</p>
<ul>
<li>The Consequence: By placing a Center Guard on Shot 1, they narrow their own scoring area. If the opponent peels this guard, the USA is back to square one but with one fewer stone. If the opponent ignores it and draws around, the USA faces a cluttered house where their own guard prevents a simple takeout. The result is often a single point (forced) or a steal.</li>
</ul>
<p><strong>The Italian Approach (Antifragile):<br>
</strong>Italy, with a PPCS of +1.75, leans into the “Shot 2 Protection” strategy.</p>
<ul>
<li>The Consequence: Italy ignores the center guard initially. They use Shot 1 to Draw to the button or the edge of the four-foot (behind the corner guard). This immediately establishes a “threat of 2.” When the opponent attempts to remove or freeze to this stone, Italy then uses Shot 2 to Guard or Freeze, locking the advantage in place. By prioritizing offense over protection in the opening sequence, they force the opponent to chase the game, increasing the probability of a multi-point end.</li>
</ul>
<p><strong>The False Clutch Problem:<br>
</strong>Finally, we must distinguish between ‘stat-padding’ and winning. By plotting PPCS against Win Probability Added (WPA), we expose the ‘False Clutch’ teams: those who score points that ultimately fail to alter the game’s outcome.</p>
<p>The data reveals a weak correlation (<span class="math inline">\(r= 0.17\)</span>) between scoring under pressure and actually winning games. This highlights a critical distinction in curling strategy: not all points are created equal.</p>
<div id="fig-ppcs-wpa" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ppcs-wpa-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="output/figures/fig6_ppcs_vs_wpa.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ppcs-wpa-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Relationship between Pressure Performance (PPCS) and Win Probability Added (WPA)
</figcaption>
</figure>
</div>
<p><strong>By cross-referencing our Pressure Performance Score (PPCS) with Win Probability Added (WPA) as shown above, we identified two distinct behavioral profiles:</strong></p>
<ul>
<li><p><strong>The “False Clutch” (e.g., Italy):</strong> Italy (ITA) ranks <strong>2nd</strong> in our model with a PPCS of <strong>+1.75</strong>, indicating they are elite at generating points under pressure. However, their position in quadrants reveals a low WPA. This suggests a “stat-padding” effect: Italy executes difficult shots effectively, but often in “garbage time” which refers to low-leverage moments where the points do not significantly alter the match outcome.</p></li>
<li><p><strong>The “True Clutch” (Efficient Scoring):</strong> In contrast, Canada (CAN) ranks <strong>3rd</strong> in PPCS at <strong>+1.33</strong>. While their raw scoring output under pressure is lower than Italy’s, their WPA is significantly higher (appearing in the top-right “True Clutch” quadrant). This indicates high <em>efficiency</em>: Canada’s points are scored in the pivotal moments that flip loss probabilities into win probabilities.</p></li>
<li><p><strong>Tactical Opportunity:</strong> For teams like New Zealand (NZL), who show very high pressure scoring but lower impact than Canada, the goal is to shift those successful shots into more impactful game scenarios.</p></li>
</ul>
</section>
</section>
<section id="discussion-and-implications" class="level2">
<h2 class="anchored" data-anchor-id="discussion-and-implications"><strong>4. Discussion and Implications</strong></h2>
<section id="for-coaches-abandon-the-shot-1-guard" class="level3">
<h3 class="anchored" data-anchor-id="for-coaches-abandon-the-shot-1-guard"><strong>4.1 For Coaches: Abandon the Shot 1 Guard</strong></h3>
<p>The prevailing intuition in mixed doubles is to “clutter the center” to prevent the opponent from having an easy path to the button. However, our data suggests this is a losing strategy on the Power Play. The <strong>Shot 1 Guard</strong> is statistically correlated with failure (OR 0.59).</p>
<p><strong>Tactical Recommendation:</strong> Coaches must instruct teams to prioritize the <strong>Draw</strong> on Shot 1. The Power Play already provides a pre-placed corner guard; adding a center guard immediately only serves to block the team’s own access to the scoring area. The optimal sequence, supported by our <strong>Shot 2 Protection Strategy</strong> findings, is <strong>Draw -&gt; Guard</strong>. Establish the point, then defend it.</p>
</section>
<section id="training-the-anxious-sniper-the-pressure-cooker-drill" class="level3">
<h3 class="anchored" data-anchor-id="training-the-anxious-sniper-the-pressure-cooker-drill"><strong>4.2 Training the Anxious Sniper: The “Pressure Cooker” Drill</strong></h3>
<p>Knowledge of the “Anxious Sniper” effect is insufficient; teams must train to override the instinctual flight to safety. We propose the following practice regimen:</p>
<p><strong>Drill: The 2-Shot Gauntlet (Pressure Cooker)</strong></p>
<ul>
<li><p><strong>Setup:</strong> Tie game, End 8 simulation. Power Play active.</p></li>
<li><p><strong>The Constraint:</strong> The team must throw a Draw on Shot 1. Throwing a Guard on Shot 1 results in an automatic loss of the drill.</p></li>
<li><p><strong>The Variable:</strong> On Shot 2, the coach dictates the move based on the opponent’s simulated play. If the opponent attempts a freeze, the team must practice the high-precision Guard or Tap-back (Shot 2 Protection).</p></li>
<li><p><strong>Scoring:</strong> Teams are scored not just on the final rest position, but on their <strong>Decision Velocity</strong>. Hesitation or debate about reverting to a “safer” shot results in a point deduction.</p></li>
<li><p><strong>Objective:</strong> This forces the team to become comfortable with an “exposed” house on Shot 1, desensitizing them to the fear that drives the “Anxious Sniper” regression.</p></li>
</ul>
</section>
<section id="for-scouts-weaponizing-the-ppcs" class="level3">
<h3 class="anchored" data-anchor-id="for-scouts-weaponizing-the-ppcs"><strong>4.3 For Scouts: Weaponizing the PPCS</strong></h3>
<p>The PPCS offers a distinct scouting advantage for the 2026 cycle.</p>
<ul>
<li><p><strong>Against Italy:</strong> They are statistically likely to become more aggressive and successful late in games. Defending against Italy requires high-risk steal attempts in Ends 6-8; playing a standard “clean” defense is ineffective because they thrive on execution under pressure.</p></li>
<li><p><strong>Against USA:</strong> The data suggests they are prone to conservative regressions. In high-pressure Power Play scenarios, they are statistically more likely to settle for 1 point or miss a complex conversion. Opponents should force the USA to make aggressive calls, knowing their statistical tendency is to retreat to safety.</p></li>
</ul>
</section>
<section id="the-false-clutch-implications" class="level3">
<h3 class="anchored" data-anchor-id="the-false-clutch-implications">4.4 The “False Clutch” Implications</h3>
<p>While our initial analysis of the “Clutch Paradox” revealed that average scoring actually increases by <strong>34.8%</strong> in very high-pressure scenarios (rising from 1.43 to 1.93 points), this aggregate lift conceals a critical strategic inefficiency. High scoring under pressure does not always correlate with winning.</p>
<p><strong>Implication for Strategy:</strong> Coaches and skips must distinguish between <em>offensive capacity</em> and <em>game impact</em>. A team like New Zealand (Rank 1, +2.67 PPCS) clearly has the technical ability to score, but to emulate Canada’s success, they must optimize <em>when</em> they deploy aggressive tactics. The data suggests that defensive shifts (like the Shot 2 Guard, which increases success by 244%) should be prioritized over aggressive scoring attempts unless the WPA leverage is high.</p>
</section>
<section id="limitations" class="level3">
<h3 class="anchored" data-anchor-id="limitations"><strong>4.4 Limitations</strong></h3>
<p>While the dataset is robust (26,000+ shots), the specific “Very High Pressure” subset for individual teams can be small. The PPCS for teams like New Zealand should be treated as indicative of potential rather than definitive proof until sample sizes increase. Furthermore, the “Anxious Sniper” theory infers psychological intent from shot selection data; without biometric data, we cannot definitively prove “anxiety,” only the resulting conservative behavior.</p>
</section>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion"><strong>5. Conclusion</strong></h2>
<p>The data tells a clear story about Mixed Doubles Curling: elite teams do not lose because they forget how to throw a stone. They lose because they forget how to call a game.</p>
<p>Our “Anxious Sniper” theory proves that while elite athletes maintain their physical execution in high-stakes moments, their tactical decision-making often degrades into counter-productive conservatism. They choose the “safe” Guard over the “winning” Draw, preserving their shooting percentage at the cost of the scoreboard.</p>
<p>For teams preparing for the 2026 cycle, the path to Power Play optimization is twofold:</p>
<ol type="1">
<li><p><strong>Psychological:</strong> Recognize that the feeling of pressure is not degrading physical skill. Trust the execution.</p></li>
<li><p><strong>Tactical:</strong> Adhere to the Shot 2 Protection Strategy. Draw first. Guard second.</p></li>
</ol>
<p>By shifting focus from “surviving” the pressure to “exploiting” the Power Play geometry through data-backed sequencing, teams can turn the sport’s “nuclear option” from a gamble into a guarantee. <strong>Pressure acts as a truth serum for strategy, not skill.</strong></p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>